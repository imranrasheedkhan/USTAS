<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head></h:head>
   
<h:body>
	<ui:composition>  
		<fieldset class="fieldset">
			<legend class="legend">
				<font color="orange" size="4">Leave Allotment</font>
			</legend>
		<table id="emp_leave_allot" class="table" cellpadding="10"
				style="width: 40%" align="center">
				<tr> 
				<td>For Year:</td>
				<td>
                <h:selectOneMenu value="#{empLeaveAllotmentMB.model.empLeaveAllotmnet.forYear}" id="for_year" required="true" requiredMessage="Select Year">
                  <f:selectItem itemLabel="Select Year" itemValue=""></f:selectItem>
                  <f:selectItem itemLabel="2010" itemValue="2010"></f:selectItem>
                  <f:selectItem  itemLabel="2011" itemValue="2011"></f:selectItem>
                  <f:selectItem  itemLabel="2012" itemValue="2012"></f:selectItem>  
                  <f:selectItem  itemLabel="2013" itemValue="2013"></f:selectItem>
               
                  <f:selectItem itemLabel="2014" itemValue="2014"></f:selectItem>
                  <f:selectItem  itemLabel="2015" itemValue="2015"></f:selectItem>
                  <f:selectItem  itemLabel="2015" itemValue="2015"></f:selectItem>
                  <f:selectItem  itemLabel="2016" itemValue="2016"></f:selectItem>
                  <a4j:ajax render="empList_table" event="change"  listener="#{empLeaveAllotmentMB.selectEmployees}"></a4j:ajax>  
                </h:selectOneMenu>
        
               </td>
               <td style="width: 100px"><rich:message for="for_year"></rich:message></td>
			    </tr>

			 </table>  
	  		  <div align="right" id="leave_Allotment" style="float:left;right:50px;top:200px;height:100%; width:700px; margin-left:20px;">
			     <rich:dataTable value="#{empLeaveAllotmentMB.model.empList}" 
					var="empRecord" id="empList_table"  rowKeyVar="rowNo"  noDataLabel="No data is available"
					style="width:100%;height:100%;text-align:center"
					styleClass="searchTable" rows="10" headerClass="searchTableHeader" 
					onrowmousemove="this.style.backgroundColor='#FFEBDA'" 
					onrowmouseout="this.style.backgroundColor='#{a4jSkin.rowBackgroundColor}'"       
					rowClasses="odd-row,even-row"> 
					<rich:column width="15%">       
						<f:facet name="header">   
						 <h:outputText  value="Select"  ></h:outputText>
<!--                            <br></br> -->
<!--                             <h:selectBooleanCheckbox id="allSelect"   onchange="checkAllCheckboxesInTable(this);" > -->
<!--                                   <a4j:ajax  event="change"   render="dataTable,empList_table" > -->
						     
<!-- 						    </a4j:ajax> -->
<!--                             </h:selectBooleanCheckbox>  -->
						</f:facet>    
						 <h:selectBooleanCheckbox  value="#{empRecord.flag}" id="checkBox"  styleClass="booleanCheckBox">
						    
						    <a4j:ajax  event="change"   render="dataTable,empList_table"   >
						     
						    </a4j:ajax>
						 
						 </h:selectBooleanCheckbox>    
						</rich:column>
					    
					<rich:column width="15%">       
						<f:facet name="header">
						<h:outputText value="Employee ID"></h:outputText>   
						</f:facet>
						<h:outputText value="#{empRecord.empNo}"></h:outputText>
						</rich:column>
						 <rich:column width="15%">
						 <f:facet name="header">
						<h:outputText value="Name"></h:outputText>
						</f:facet>
						<h:outputText value="#{empRecord.firstName} #{empRecord.lastName}"></h:outputText>  
					    </rich:column>
					    
					     <rich:column width="30%">
						 <f:facet name="header">
						<h:outputText value="Allot Leave"></h:outputText>  
						</f:facet>
                            <a4j:commandLink disabled="#{!(empRecord.flag)}" value="Click" render="dataTable,empList_table"  action="#{empLeaveAllotmentMB.selectLeaveEmployee}" execute="@this" oncomplete="#{rich:component('Allot_LeavePanel')}.show();" >
                                 
                                  <f:setPropertyActionListener  target="#{empLeaveAllotmentMB.model.empInfo}" value="#{empRecord}"></f:setPropertyActionListener>
                              
                            </a4j:commandLink>
					    </rich:column> 
					        
					  <f:facet name="footer"> 
               <rich:dataScroller for="empList_table"  execute="empList_table"
                maxPages="10" renderIfSinglePage="false" boundaryControls="hide" fastControls="hide"/>  
               </f:facet>
  
   
			 </rich:dataTable>  
			  
			  </div>   
				</fieldset>
				 <br/>
				 <div style="width: 100%" align="right">
			     <h:button value="Clear" style="Width:70px;height:30px"></h:button>
			    &nbsp;
			   <a4j:commandButton execute="@form" value="Save"
				style="Width:70px;height:30px" render="empList_table" onclick="if(!selectCheckBox()) return false;" actionListener="#{empLeaveAllotmentMB.addAllotedLeave}"   oncomplete="if(#{!facesContext.validationFailed})#{rich:component('confirmation')}.show();"></a4j:commandButton>
			   &nbsp;
<!-- 			<a4j:commandButton value="Update"   style="Width:70px;height:30px"></a4j:commandButton> -->
		   </div>
		<br />
		<br />     
		<br /> 
		
      <rich:popupPanel id="Allot_LeavePanel"  domElementAttachment="form"
            autosized="true"  moveable="false" zindex="2000" height="200" width="500" 
            onmaskclick="#{rich:component('Allot_LeavePanel')}.hide()"   >
        
            <rich:dataTable value="#{empLeaveAllotmentMB.model.empInfo.empLeaveAllotment}" var="record" 
             id="dataTable"	style="width:100%;height:100%;text-align:center"  >
				  <rich:column width="15%">       
			     <f:facet name="header">
		        <h:outputText value="Leave Type"></h:outputText>      
					</f:facet>
				    <h:outputText value="#{record.leaveInfos.shortName}"></h:outputText>
				  </rich:column>
			     <rich:column width="15%">           
				  <f:facet name="header">
				   <h:outputText value="Days"></h:outputText>    
					</f:facet>
		            <h:inputText  styleClass="dayInputText" id="days"   onblur="validateDays(this);" maxlength="5" value="#{record.noOfDays}"  size="10">    
		                    <a4j:ajax  event="change" execute="days"  render="days"/>
		            </h:inputText>     
		   </rich:column>
						   
			 </rich:dataTable>
         
        </rich:popupPanel>   
          
				</ui:composition>
		  </h:body>
	    </html>